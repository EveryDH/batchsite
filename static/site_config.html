<!-- 节点管理页面 -->
<!DOCTYPE html>
<html class="x-admin-sm">

<head>
    <meta charset="UTF-8"/>
    <title>管理后台</title>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <link rel="stylesheet" href="src/x-admin/css/font.css"/>
    <link rel="stylesheet" href="src/x-admin/css/xadmin.css"/>
    <link rel="stylesheet" href="src/x-admin/lib/layui/css/layui.css" media="all"/>
    <script type="text/javascript" src="/static/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="src/x-admin/lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="src/x-admin/lib/layui/layui.all.js" charset="utf-8"></script>
    <script type="text/javascript" src="src/x-admin/js/xadmin.js"></script>
    <script type="text/javascript" src="src/x-admin/js/batchsite.js"></script>
    <style>
        .layui-input-block {
            width: 100px;
        }

        .bt-form {
            height: 100%;
            padding-bottom: 70px;
            padding: 20px;
        }

        #form-item-click {
            width: 300px;
            left: 200px
        }
    </style>
</head>

<body>
<div data-id="form_PtmWkF" class="bt-form">
    <form class="layui-form">
        <div class="layui-form-item">
            <label class="layui-form-label">根目录</label>
            <div class="layui-input-block" style="width:330px">
                <input type="text" name="path" placeholder="请输入" autocomplete="off" class="layui-input"
                       value="/www/wwwroot/"/>
            </div>
        </div>
        <!--       <div class="layui-form-item">
                   <label class="layui-form-label">数据库</label>
                   <div class="layui-input-block" style="width:330px">
                       <input type="text" name="datauser" class="layui-input"
                              value=数据库账号>
                       <br>
                       <input type="text" name="datapassword" class="layui-input"
                              value="数据库密码"/>
                   </div>
               </div>
               <div class="layui-form-item">
                   <label class="layui-form-label">FTP</label>
                   <div class="layui-input-block" style="width:330px">
                       <input type="text" name="ftp_username" class="layui-input"
                              value=FTP账号>
                       <br>
                       <input type="text" name="ftp_password" class="layui-input"
                              value="FTP密码"/>
                   </div>
               </div>
               -->
        <div class="layui-form-item">
            <label class="layui-form-label">程序类型</label>
            <div class="layui-input-block">
                <select name="type">
                    <option value="PHP">PHP</option>
                    <option value="Asp">Asp</option>
                    <option value="Aspx">Aspx</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">PHP版本</label>
            <div class="layui-input-block">
                <select name="version">
                    <option value="54">PHP-54</option>
                    <option value="00">纯静态</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">端口</label>
            <div class="layui-input-block" style="width:100px">
                <input type="text" name="port" class="layui-input" value="80"/>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">部署软件zip包</label>
            <div class="layui-input-block">
                <select name="zip" id="option_list">
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block" name="form-item-click" style="width:300px; left: 250px">
                <button type="submit" class="layui-btn" lay-submit="" lay-filter="submit-commit">立即提交</button>
            </div>
        </div>
    </form>
</div>
</body>
<script>

    var load;
    var layer;
    layui.config({
        version: '1583393622929' //为了更新 js 缓存，可忽略
    });
    layui.use('form', function () {
        form = layui.form;
        OptionCodeList();
    });
    form.render();

    //监听提交
    form.on('submit(submit-commit)', function (data) {
        sdata = JSON.stringify(data.field)
        console.log(sdata);
        add_domain_list(sdata);
        return false
    });

    function add_domain_list(sdata) {
        request_plugin("batchsite", "add_domain_list", {'domain_info': sdata}, function (rdata) {
            if (rdata["status"] == "Success") {
                // layer.msg('批量添加站点成功! 共添加： ' + rdata.size +' 个', {icon: 1, time: 3000});
                layer.msg('批量添加站点成功! 共添加： ' + rdata.site + ' 个', {icon: 1, time: 3000});
            }
        })
    }

    // 搜索当前的可用插件的安装包
    function OptionCodeList() {
        request_plugin("batchsite", "GetInstallList", "", function (rdata) {
            if (rdata["status"] == "Success") {
                var html = '';
                console.log(rdata["List"]);
                for (var i = 0; i < rdata["List"].length; i++) {
                    html = '<option value="' + rdata["List"][i] + '">' + rdata["List"][i] + '</option>>';
                }
                $("#option_list").html(html);
                form.render('select');
            }
        });
    }

</script>

</html>